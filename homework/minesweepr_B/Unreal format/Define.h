#pragma once

using std::cout;
using std::endl;

constexpr auto One = 49;
constexpr auto Nine = 57;;

enum
{
	Level = 3,
};

struct Map
{
	static inline int stage = 0;

	static inline int LV1_x = 20;
	static inline int LV1_y = 9;
	static inline int LV2_x = 28;
	static inline int LV2_y = 13;
	static inline int LV3_x = 39;
	static inline int LV3_y = 19;
	static inline int n = 48;

	static inline char MapData[Level][19][40] =
	{
		{
			"--------------------",//0
			"|                  |",//1 // 20
			"|                  |",//2
			"|                  |",//3
			"|                  |",//4
			"|                  |",//5
			"|                  |",//6
			"|                  |",//7
			"--------------------",//8
		},
		{
			"----------------------------",//0
			"|                          |",//1 //28
			"|                          |",//2
			"|                          |",//3
			"|                          |",//4
			"|                          |",//5
			"|                          |",//6
			"|                          |",//7
			"|                          |",//8
			"|                          |",//9
			"|                          |",//10
			"|                          |",//11
			"----------------------------",//12
		},
		{
			"---------------------------------------",//0
			"|                                     |",//1 // 39
			"|                                     |",//2
			"|                                     |",//3
			"|                                     |",//4
			"|                                     |",//5
			"|                                     |",//6
			"|                                     |",//7
			"|                                     |",//8
			"|                                     |",//9
			"|                                     |",//10
			"|                                     |",//11
			"|                                     |",//12
			"|                                     |",//13
			"|                                     |",//14
			"|                                     |",//15
			"|                                     |",//16
			"|                                     |",//17
			"---------------------------------------",//18
		}
	};

	static inline char DData[Level][19][40] =
	{
		{
			"--------------------",//0
			"|##################|",//1 // 20
			"|##################|",//2
			"|##################|",//3
			"|##################|",//4
			"|##################|",//5
			"|##################|",//6
			"|##################|",//7
			"--------------------",//8
		},
		{
			"----------------------------",//0
			"|##########################|",//1 //28
			"|##########################|",//2
			"|##########################|",//3
			"|##########################|",//4
			"|##########################|",//5
			"|##########################|",//6
			"|##########################|",//7
			"|##########################|",//8
			"|##########################|",//9
			"|##########################|",//10
			"|##########################|",//11
			"----------------------------",//12
		},
		{
			"---------------------------------------",//0
			"|#####################################|",//1 // 39
			"|#####################################|",//2
			"|#####################################|",//3
			"|#####################################|",//4
			"|#####################################|",//5
			"|#####################################|",//6
			"|#####################################|",//7
			"|#####################################|",//8
			"|#####################################|",//9
			"|#####################################|",//10
			"|#####################################|",//11
			"|#####################################|",//12
			"|#####################################|",//13
			"|#####################################|",//14
			"|#####################################|",//15
			"|#####################################|",//16
			"|#####################################|",//17
			"---------------------------------------",//18
		}
	};

	void Draw(int st, int X, int Y)
	{
		for (int y = 0; y < Y; ++y)
		{
			for (int x = 0; x < X; ++x)
			{
				if ((rand() % 5) == 3 && y > 1 && x > 1 && y < Y - 1 && x < X - 1)
				{
					MapData[st][y][x] = '*';
				}
			}
		}//

		for (int i = 0; i < Y; ++i)
		{
			for (int j = 0; j < X; ++j)
			{
				for (int r = -1; r < 2; ++r)
					for (int c = -1; c < 2; ++c)
					{
						if (!(r | c))continue;

						if (GetMap(st, j, i) != '-' && GetMap(st, j, i) != '|' && GetMap(st, j, i) != '*')

							if (i + r >= 0 and i + r < Y and j + c >= 0 and j + c < X && GetMap(st, j + r, i + c) == '*')

								++n;
					}

				if (n > 48)
				{
					MapData[st][i][j] = n;
					n = 48;
				}
			}
		}//
	}

	void DrawMap(int st, int X, int Y)
	{
		for (int y = 0; y < Y; ++y)
		{
			for (int x = 0; x < X; ++x)
			{
				std::cout << DData[st][y][x];
			}
			std::cout << std::endl;
		}
	}

	char GetMap(int st, int x, int y) { return MapData[st][y][x]; }
};

static void gotoxy(int x, int y)
{
	COORD Cur;
	Cur.X = x;
	Cur.Y = y;
	SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), Cur);
}

